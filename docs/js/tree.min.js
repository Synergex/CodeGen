/*! HelpSmith Web Help System 4.0
* https://www.helpsmith.com
* Copyright (c) 2007-2024 Divcom Software */
'use strict';(function(l){function h(a,b){function d(e){var k=e.data("link");if(k)k.on("click",function(g){g.preventDefault();g.stopPropagation();if("function"!==typeof c.options.onClick||!0!==c.options.onClick(g,e))2!==g.detail?0<c.options.autoExpand&&(1==c.options.autoExpand&&"#"==k.attr("href")||2==c.options.autoExpand)&&(c.autoExpanded=c.expandNode(e)):c.options.expandOnDblClick&&(c.autoExpanded||c.toggleNode(e),c.autoExpanded=null),c.setActiveNode(e)}).on("keydown",function(g){var f=e;switch(g.which){case 32:g.preventDefault();
c.setActiveNode(f);break;case 38:g.preventDefault();(f=c.getPrevNode(f,!0))&&c.setNodeFocused(f);break;case 40:g.preventDefault();(f=c.getNextNode(f,!0))&&c.setNodeFocused(f);break;case 37:g.preventDefault();f.find("> ul:visible").length?c.expandNode(f,!1):(f=c.getParent(f))&&c.setNodeFocused(f);break;case 39:g.preventDefault(),(g=c.getFirstChild(f,!0))?c.setNodeFocused(g):c.expandNode(f)}})}var c=this;c.$container=a;c.activeNode=null;c.allowFx=!0;c.options=l.extend({expandSpeed:100,expandOnDblClick:!0,
autoExpand:0,autoCollapse:!1,noButtons:!1,noIcons:!1,data:null,onQueryExpand:null,onActivate:null,onDeactivate:null,onCanReActivate:null,onClick:null,onExpand:null,onCreateNode:null},b);c.$container.addClass("hstree-container");c.$root=c.$container.find("> ul");0==c.$root.length&&(c.$root=l("<ul></ul>"),c.$container.append(c.$root));c.$root.addClass("hstree-root");if(c.options.data){c.$root.empty();function e(k,g){l.each(k,function(){var f=l("<li></li>");if("function"===typeof c.options.onCreateNode)c.options.onCreateNode(f,
this);var m=l("<a></a>").text(this.title).appendTo(f);m.attr("href",this.href?this.href:"#");this.target&&m.attr("target",this.target);g.append(f);this.children&&(f=l("<ul></ul>").appendTo(f),e(this.children,f));return!0})}e(c.options.data,c.$root);c.options.data=null}c.$container.find("li").each(function(){var e=l(this);e.addClass("hstree-node");var k=e.find("> ul").detach();k.length&&e.addClass("hstree-has-children");var g="",f=e.find("> a");f.length?(g=f.text(),f.empty()):(g=e.text(),f=l('<a href="#"></a>'),
e.append(f));g&&f.attr("title",g);e.data("title",g);var m=null;c.options.noButtons||(m=l('<div class="hstree-node-btn"></div>'),m.append("<i></i>"));var p=null;c.options.noIcons||(p=l('<div class="hstree-node-icon"></div>'),p.append("<i></i>"));var r=l('<div class="hstree-node-title"></div>');g&&r.append(g);m&&f.append(m);p&&f.append(p);f.append(r);e.append(k);e.data("link",f);d(e);if(p)p.on("click",function(n){!m&&k.length&&(n.preventDefault(),n.stopPropagation(),c.toggleNode(e))});if(k.length&&
(e.addClass("hstree-collapsed"),m))m.find("> i").on("click",function(n){n.preventDefault();n.stopPropagation();c.toggleNode(e);f.focus()}).on("dblclick",function(n){n.preventDefault();n.stopPropagation();f.focus()})})}function t(a,b,d,c){if(!b||a.isNodeValid(b))if(b?(a=b.find("> ul"),b=1==a.length&&a.is(":visible")):(a=a.$root,b=!0),1==a.length&&("undefined"==c||!c||b)&&(d=a.find("> .hstree-node:"+d+"-child"),1==d.length))return d;return null}function u(a,b){if("function"===typeof a.options.onActivate)a.options.onActivate(b)}
h.prototype.getNodeTarget=function(a){return a&&(a=a.data("link"))?{href:a.attr("href"),target:a.attr("target")}:null};h.prototype.setNodeFocused=function(a){return a&&(a=a.data("link"))?(a.focus(),!0):!1};h.prototype.getFirstChild=function(a,b){return t(this,a,"first",b)};h.prototype.getLastChild=function(a,b){return t(this,a,"last",b)};h.prototype.getNextSibling=function(a){return this.isNodeValid(a)&&(a=a.next(),1==a.length)?a:null};h.prototype.getPrevSibling=function(a){return this.isNodeValid(a)&&
(a=a.prev(),1==a.length)?a:null};h.prototype.getParent=function(a){return this.isNodeValid(a)&&(a=a.parent("ul:not(.hstree-root)").parent(".hstree-node"),a.length)?a:null};h.prototype.getNextNode=function(a,b){if(b=this.getFirstChild(a,b))return b;if(!a)return null;for(;;){if(b=this.getNextSibling(a))return b;if(b=this.getParent(a))a=b;else return null}};h.prototype.getPrevNode=function(a,b){var d=this.getPrevSibling(a);return d?(a=this.getLastChild(d,b))?a:d:(d=this.getParent(a))&&!d.is(this.$root)?
d:null};h.prototype.isNodeValid=function(a){return a&&1==a.length&&a.hasClass("hstree-node")};h.prototype.expandNode=function(a,b){if(!this.isNodeValid(a))return!1;var d=a.find("> ul");if(!d.length)return!1;"undefined"===typeof b&&(b=!0);if("function"===typeof this.options.onQueryExpand&&!1===this.options.onQueryExpand(a,b))return!1;var c=this.allowFx&&0<this.options.expandSpeed,e=d.is(":visible");if(b){if(!e)return a.removeClass("hstree-collapsed").addClass("hstree-expanded"),c?d.slideDown(this.options.expandSpeed):
d.show(),this.collapseOther(a),!0}else if(e)return a.removeClass("hstree-expanded").addClass("hstree-collapsed"),c?d.slideUp(this.options.expandSpeed):d.hide(),!0;return!1};h.prototype.toggleNode=function(a){var b=a.find("> ul");return b.length?this.expandNode(a,!b.is(":visible")):!1};h.prototype.getActiveNode=function(){return this.activeNode};h.prototype.setActiveNode=function(a,b){function d(k,g){for(k=c.getParent(k);k;)g?k.addClass("hstree-active-parent"):k.removeClass("hstree-active-parent"),
k=c.getParent(k)}var c=this;if(!a||this.isNodeValid(a)){if(!this.activeNode&&!a)return!0;var e;if(e=this.activeNode&&a&&this.activeNode.is(a))e="function"===typeof this.options.onCanReActivate?this.options.onCanReActivate(a):!1,e=!e;if(e)return!0;if(this.activeNode){e=this.activeNode;this.activeNode.removeClass("hstree-active");this.activeNode=null;if("function"===typeof this.options.onDeactivate)this.options.onDeactivate(e);d(e,!1)}return a?this.isNodeValid(a)?(this.activeNode=a,a.addClass("hstree-active"),
d(a,!0),"undefined"!==typeof b&&b||u(this,a),!0):!1:!0}};h.prototype.reActivateNode=function(){return this.activeNode?(u(this,this.activeNode),!0):!1};h.prototype.collapseOther=function(a){if(this.options.autoCollapse&&this.isNodeValid(a)){var b=this;a.siblings().each(function(){b.expandNode(l(this),!1)})}};h.prototype.getNodeByData=function(a,b){var d=this.$root.find(".hstree-node");if(0==d.length)return null;var c=null;d.each(function(){var e=l(this);return e.data(a)==b?(c=e,!1):!0});return c};
h.prototype.checkNodeURL=function(a,b){if(!a)return!1;if("string"===typeof b)try{var d=new URL(b)}catch(c){return console.error(c.message+': "'+b+'"'),!1}else d=b;if((a=this.getNodeTarget(a))&&"#"!=a.href){b=null;try{b=new URL(a.href,d)}catch(c){console.error(c.message)}if(b&&d.protocol==b.protocol&&d.host==b.host&&d.port==b.port&&d.pathname.toLowerCase()==b.pathname.toLowerCase())return!0}return!1};h.prototype.getNodeByURL=function(a){var b=this,d=this.$root.find(".hstree-node");if(0==d.length)return null;
try{var c=new URL(a)}catch(k){return console.error(k.message+': "'+a+'"'),null}var e=null;d.each(function(){var k=l(this);return b.checkNodeURL(k,c)?(e=k,!1):!0});return e};h.prototype.expandAll=function(a){if(!(0>a)){var b=this,d=this.$root.find(".hstree-node.hstree-collapsed");if(0!=d.length){var c=b.allowFx;try{b.allowFx=!1,d.each(function(){var e=l(this);e.parentsUntil(this.$root,".hstree-node").length<=a&&b.expandNode(e);return!0})}finally{b.allowFx=c}}}};h.prototype.viewNode=function(a){var b=
this;if(b.isNodeValid(a)){var d=b.allowFx;try{b.allowFx=!1,a.parents(".hstree-node").each(function(){b.expandNode(l(this))})}finally{b.allowFx=d}return!0}return!1};h.prototype.getChildren=function(a){var b={children:[],list:null};"undefined"!==typeof a&&a?this.isNodeValid(a)&&(b.list=a.find("> ul")):b.list=this.$root;b.list&&b.list.length&&b.list.find("> li.hstree-node").each(function(){b.children.push(this)});return b};h.prototype.sortChildren=function(a,b){b=this.getChildren(b);if(b.children.length){l(b.children[b.children.length-
1]).removeClass("hstree-last");for(var d=[],c=0;c<b.children.length;c++)d.push(l(b.children[c]).detach());d.sort(a);b.list.append(d);b.list.find("> li:last-child").addClass("hstree-last")}};var q={init:function(a){return this.each(function(){var b=l(this);b.data("hsTree")||!b.find("> ul").length&&!a.data||b.data("hsTree",new h(b,a))})},getNodeTarget:function(a){var b=this.first().data("hsTree");return b?b.getNodeTarget(a):null},setNodeFocused:function(a){var b=this.first().data("hsTree");return b?
b.setNodeFocused(a):!1},getActiveNode:function(){var a=this.first().data("hsTree");return a?a.getActiveNode():null},setActiveNode:function(a,b){var d=this.first().data("hsTree");return d?(b=d.setActiveNode(a,b),a&&b&&d.viewNode(a),b):!1},reActivateNode:function(){var a=this.first().data("hsTree");a&&a.reActivateNode()},getNodeByData:function(a,b){var d=this.first().data("hsTree");return d?d.getNodeByData(a,b):null},checkNodeURL:function(a,b){var d=this.first().data("hsTree");return d?d.checkNodeURL(a,
b):!1},getNodeByURL:function(a){var b=this.first().data("hsTree");return b?b.getNodeByURL(a):null},expandAll:function(a){var b=this.first().data("hsTree");if(b)return b.expandAll(a)},expandNode:function(a,b){var d=this.first().data("hsTree");return d?d.expandNode(a,b):!1},getChildren:function(a){var b=this.first().data("hsTree");return b?b.getChildren(a).children:[]},sortChildren:function(a,b){var d=this.first().data("hsTree");d&&d.sortChildren(a,b)}};l.fn.hsTree=function(a){if(q[a])return q[a].apply(this,
Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)l.error("Method "+a+" does not exist on jQuery.hsTree");else return q.init.apply(this,arguments)}})(jQuery);